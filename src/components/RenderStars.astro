---
import { Icon } from 'astro-icon/components';

const MAX_STARS = 5;

// Define astro props type
export interface RenderStarsProps {
  rating: number;
}

const { rating } = Astro.props;

const fullStars = Math.floor(rating);
const halfStarDecimal = rating % 1;
const emptyStars = MAX_STARS - Math.ceil(rating);
---
<div 
    role="img" 
    aria-label={`${rating.toFixed(1)} out of 5 stars`} 
    class="flex"
    aria-valuenow={rating.toFixed(1)}
    aria-valuemin="0"
    aria-valuemax="5"
    title={`${rating.toFixed(1)} out of 5 stars`}
>
    {
        Array.from({ length: fullStars }).map((_, index) => (
            <Icon 
                name="fa-solid:star"
                class="text-yellow-400"
                style={{
                    stroke: 'black',
                    strokeWidth: '10px', 
                    fontSize: '24px'
                }}
                key={`full-${index}`}
            />
        ))
    }
    {
        halfStarDecimal > 0 && (
            <div
                style={{
                    position: 'relative',
                    display: 'inline-block',
                    width: '1.13em',
                    height: '1em',
                    fontSize: '24px'
                }}
            >
                <svg width="1.13em" height="1em" viewBox="0 0 576 512">
                    <defs>
                        <linearGradient id="half-grad" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset={`${halfStarDecimal * 100}%`} style="stop-color: #FFD700; stop-opacity: 1" />
                            <stop offset={`${halfStarDecimal * 100}%`} style="stop-color: #D3D3D3; stop-opacity: 1" />
                        </linearGradient>
                    </defs>
                    <path 
                        fill="url(#half-grad)" 
                        d="M316.9 18c-5.3-11-16.5-18-28.8-18s-23.4 7-28.8 18L195 150.3L51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329l-24.6 145.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5l128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329l104.2-103.1c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7l-143.7-21.2z"
                        style={{
                            stroke: 'black',
                            strokeWidth: '10px'
                        }}
                    />
                </svg>
            </div>
        )
    }
    {
        Array.from({ length: emptyStars }).map((_, index) => (
            <Icon 
                name="fa-solid:star"
                class="text-gray-400"
                style={{
                    stroke: 'black',
                    strokeWidth: '10px', 
                    fontSize: '24px'
                }}
                key={`empty-${index}`}
            />
        ))
    }
</div>
